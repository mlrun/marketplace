
<!DOCTYPE html>

<html lang="en">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/><meta content="Docutils 0.17.1: http://docutils.sourceforge.net/" name="generator"/>
<title>Noise Reduction</title>
<!-- Loaded before other Sphinx assets -->
<link href="../../../_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet"/>
<link href="../../../_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet"/>
<link href="../../../_static/vendor/fontawesome/5.13.0/css/all.min.css" rel="stylesheet"/>
<link as="font" crossorigin="" href="../../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2" rel="preload" type="font/woff2"/>
<link as="font" crossorigin="" href="../../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2" rel="preload" type="font/woff2"/>
<link href="../../../_static/pygments.css" rel="stylesheet" type="text/css">
<link href="../../../_static/styles/sphinx-book-theme.css?digest=5115cc725059bd94278eecd172e13a965bf8f5a9" rel="stylesheet" type="text/css">
<link href="../../../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" rel="stylesheet" type="text/css">
<link href="../../../_static/togglebutton.css" rel="stylesheet" type="text/css">
<!-- Pre-loaded scripts that we'll load fully later -->
<link as="script" href="../../../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf" rel="preload"/>
<script src="../../../_static/scripts/sphinx-book-theme.js?digest=9c920249402e914e316237a7dbc6769907cce411"></script>
<script data-url_root="./" id="documentation_options" src="../../../_static/documentation_options.js"></script>
<script src="../../../_static/jquery.js"></script>
<script src="../../../_static/underscore.js"></script>
<script src="../../../_static/doctools.js"></script>
<script>let toggleHintShow = 'Click to show';</script>
<script>let toggleHintHide = 'Click to hide';</script>
<script>let toggleOpenOnPrint = 'true';</script>
<script src="../../../_static/togglebutton.js"></script>
<script src="../../../_static/scripts/sphinx-book-theme.js"></script>
<script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
<link href="genindex.html" rel="index" title="Index">
<link href="search.html" rel="search" title="Search">
<meta content="width=device-width, initial-scale=1" name="viewport"/>
<meta content="en" name="docsearch:language"/>
<!-- Google Analytics -->
</link></link></link></link></link></link></head>
<body data-offset="60" data-spy="scroll" data-target="#bd-toc-nav">
<!-- Checkboxes to toggle the left sidebar -->
<input aria-label="Toggle navigation sidebar" class="sidebar-toggle" id="__navigation" name="__navigation" type="checkbox"/>
<label class="overlay overlay-navbar" for="__navigation">
<div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input aria-label="Toggle in-page Table of Contents" class="sidebar-toggle" id="__page-toc" name="__page-toc" type="checkbox"/>
<label class="overlay overlay-pagetoc" for="__page-toc">
<div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>
<div class="container-fluid" id="banner"></div>
<div class="container-xl">
<div class="row">
<!-- Sidebar -->
<div class="bd-sidebar noprint single-page" id="site-navigation">
</div>
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
<div class="header-article row sticky-top noprint">
<div class="col py-1 d-flex header-article-main">
<div class="header-article__left">
</div>
<div class="header-article__right">
<button class="headerbtn" data-placement="bottom" data-toggle="tooltip" onclick="toggleFullScreen()" title="Fullscreen mode">
<span class="headerbtn__icon-container">
<i class="fas fa-expand"></i>
</span>
</button>
<div class="menu-dropdown menu-dropdown-repository-buttons">
<button aria-label="Source repositories" class="headerbtn menu-dropdown__trigger">
<i class="fab fa-github"></i>
</button>
<div class="menu-dropdown__content">
<ul>
<li>
<a class="headerbtn" data-placement="left" data-toggle="tooltip" href="https://github.com/mlrun/marketplace" title="Source repository">
<span class="headerbtn__icon-container">
<i class="fab fa-github"></i>
</span>
<span class="headerbtn__text-container">repository</span>
</a>
</li>
<li>
<a class="headerbtn" data-placement="left" data-toggle="tooltip" href="https://github.com/mlrun/marketplace/issues/new?title=Issue%20on%20page%20%2Fnoise_reduction_example.html&amp;body=Your%20issue%20content%20here." title="Open an issue">
<span class="headerbtn__icon-container">
<i class="fas fa-lightbulb"></i>
</span>
<span class="headerbtn__text-container">open issue</span>
</a>
</li>
<li>
<a class="headerbtn" data-placement="left" data-toggle="tooltip" href="https://github.com/mlrun/marketplace/edit/master/docs/noise_reduction_example.ipynb" title="Edit this page">
<span class="headerbtn__icon-container">
<i class="fas fa-pencil-alt"></i>
</span>
<span class="headerbtn__text-container">suggest edit</span>
</a>
</li>
</ul>
</div>
</div>
<div class="menu-dropdown menu-dropdown-download-buttons">
<button aria-label="Download this page" class="headerbtn menu-dropdown__trigger">
<i class="fas fa-download"></i>
</button>
<div class="menu-dropdown__content">
<ul>
<li>
<a class="headerbtn" data-placement="left" data-toggle="tooltip" href="../src/noise_reduction.ipynb" title="Download source file">
<span class="headerbtn__icon-container">
<i class="fas fa-file"></i>
</span>
<span class="headerbtn__text-container">.ipynb</span>
</a>
</li>
<li>
<button class="headerbtn" data-placement="left" data-toggle="tooltip" onclick="printPdf(this)" title="Print to PDF">
<span class="headerbtn__icon-container">
<i class="fas fa-file-pdf"></i>
</span>
<span class="headerbtn__text-container">.pdf</span>
</button>
</li>
</ul>
</div>
</div>
<label class="headerbtn headerbtn-page-toc" for="__page-toc">
<span class="headerbtn__icon-container">
<i class="fas fa-list"></i>
</span>
</label>
</div>
</div>
<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
<div class="tocsection onthispage pt-5 pb-3">
<i class="fas fa-list"></i> Contents
    </div>
<nav aria-label="Page" id="bd-toc-nav">
<ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#table-of-contents">
   Table of Contents
  </a>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#introduction">
   Introduction
  </a>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#setting-up-a-project">
   Setting up a project
  </a>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#noise-reduction-techniques">
   Noise Reduction Techniques
  </a>
<ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry">
<a class="reference internal nav-link" href="#deepfilternet">
     1. DeepFilterNet
    </a>
</li>
<li class="toc-h3 nav-item toc-entry">
<a class="reference internal nav-link" href="#parameters">
     Parameters:
    </a>
<ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry">
<a class="reference internal nav-link" href="#example">
       1.1. Example
      </a>
</li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry">
<a class="reference internal nav-link" href="#looking-at-the-result">
     Looking at the result
    </a>
</li>
<li class="toc-h3 nav-item toc-entry">
<a class="reference internal nav-link" href="#spectral-gating">
     2. Spectral Gating
    </a>
</li>
<li class="toc-h3 nav-item toc-entry">
<a class="reference internal nav-link" href="#id1">
     Parameters:
    </a>
<ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry">
<a class="reference internal nav-link" href="#id2">
       2.1. Example
      </a>
</li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry">
<a class="reference internal nav-link" href="#id3">
     Looking at the result
    </a>
</li>
</ul>
</li>
</ul>
</nav>
</div>
</div>
<div class="article row">
<div class="col pl-md-3 pl-lg-5 content-container">
<!-- Table of contents that is only displayed when printing the page -->
<div class="onlyprint" id="jb-print-docs-body">
<h1>Noise Reduction</h1>
<!-- Table of contents -->
<div id="print-main-content">
<div id="jb-print-toc">
<div>
<h2> Contents </h2>
</div>
<nav aria-label="Page">
<ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#table-of-contents">
   Table of Contents
  </a>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#introduction">
   Introduction
  </a>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#setting-up-a-project">
   Setting up a project
  </a>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#noise-reduction-techniques">
   Noise Reduction Techniques
  </a>
<ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry">
<a class="reference internal nav-link" href="#deepfilternet">
     1. DeepFilterNet
    </a>
</li>
<li class="toc-h3 nav-item toc-entry">
<a class="reference internal nav-link" href="#parameters">
     Parameters:
    </a>
<ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry">
<a class="reference internal nav-link" href="#example">
       1.1. Example
      </a>
</li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry">
<a class="reference internal nav-link" href="#looking-at-the-result">
     Looking at the result
    </a>
</li>
<li class="toc-h3 nav-item toc-entry">
<a class="reference internal nav-link" href="#spectral-gating">
     2. Spectral Gating
    </a>
</li>
<li class="toc-h3 nav-item toc-entry">
<a class="reference internal nav-link" href="#id1">
     Parameters:
    </a>
<ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry">
<a class="reference internal nav-link" href="#id2">
       2.1. Example
      </a>
</li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry">
<a class="reference internal nav-link" href="#id3">
     Looking at the result
    </a>
</li>
</ul>
</li>
</ul>
</nav>
</div>
</div>
</div>
<main id="main-content" role="main">
<div>
<section id="noise-reduction">
<h1>Noise Reduction<a class="headerlink" href="#noise-reduction" title="Permalink to this headline">#</a></h1>
<section id="table-of-contents">
<h2>Table of Contents<a class="headerlink" href="#table-of-contents" title="Permalink to this headline">#</a></h2>
<ol class="arabic simple">
<li><p><span class="xref myst">Introduction</span></p></li>
<li><p><span class="xref myst">Project Setup</span></p></li>
<li><p><span class="xref myst">Noise Reduction Techniques</span></p>
<ol class="arabic simple">
<li><p><span class="xref myst">DeepFilterNet</span></p></li>
<li><p><span class="xref myst">Spectral Gating</span></p></li>
</ol>
</li>
</ol>
</section>
<section id="introduction">
<h2>Introduction<a class="headerlink" href="#introduction" title="Permalink to this headline">#</a></h2>
<p>Noise reduction is a crucial signal processing technique used to enhance the quality of signals by minimizing unwanted or irrelevant noise. This technique finds applications in various fields such as audio processing, image processing, telecommunications, and more. The goal is to extract the useful information from a signal while suppressing undesirable background noise.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">mlrun</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="setting-up-a-project">
<h2>Setting up a project<a class="headerlink" href="#setting-up-a-project" title="Permalink to this headline">#</a></h2>
<p>First of all we need to create a project with the <code class="docutils literal notranslate"><span class="pre">noise-reduction</span></code> function</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Creating a project</span>
<span class="n">project</span> <span class="o">=</span> <span class="n">mlrun</span><span class="o">.</span><span class="n">get_or_create_project</span><span class="p">(</span><span class="s2">"noise-reduction"</span><span class="p">)</span>
<span class="c1"># Importing the function from hub</span>
<span class="n">noise_reduction_function</span> <span class="o">=</span> <span class="n">project</span><span class="o">.</span><span class="n">set_function</span><span class="p">(</span><span class="s2">"hub://noise_reduction"</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&gt; 2024-03-04 15:54:53,561 [info] Project loaded successfully: {'project_name': 'noise-reduction'}
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Audio source can be either a single file or a directory of audio files</span>
<span class="n">audio_source</span> <span class="o">=</span> <span class="s2">"data"</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="noise-reduction-techniques">
<h2>Noise Reduction Techniques<a class="headerlink" href="#noise-reduction-techniques" title="Permalink to this headline">#</a></h2>
<p><a id="DeepFilterNet"></a></p>
<section id="deepfilternet">
<h3>1. DeepFilterNet<a class="headerlink" href="#deepfilternet" title="Permalink to this headline">#</a></h3>
<p><img alt="image.png" src="attachment:e48ce103-14f3-421d-82a4-823344895241.png"/></p>
<p>In order to use this technique, you simply need to use the <code class="docutils literal notranslate"><span class="pre">reduce_noise_dfn</span></code> handler.</p>
<p>Reduce noise from audio files using DeepFilterNet. For more information about the noise reduction algorithm, see <a class="reference external" href="https://github.com/Rikorose/DeepFilterNet">DeepFilterNet GitHub</a>. Notice that the saved files are in wav format, even if the original files are in other formats.</p>
</section>
<section id="parameters">
<h3>Parameters:<a class="headerlink" href="#parameters" title="Permalink to this headline">#</a></h3>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">audio_source</span></code>: path to the audio file or directory of audio files</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">target_directory</span></code>: path to the target directory to save cleaned audio files</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">pad</span></code>: whether to pad the audio file with zeros before cleaning</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">atten_lim_db</span></code>: maximum attenuation in dB</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">silence_threshold</span></code>: the threshold to remove silence from the audio, in dB. If None, no silence removal is performed.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">use_multiprocessing</span></code>: Number of processes to use for cleaning the audio files. If 0, no multiprocessing is used.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">verbose</span></code>: verbosity level. If True, display progress bar and logs.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">kwargs</span></code>: additional arguments to pass to <code class="docutils literal notranslate"><span class="pre">torchaudio.load()</span></code>. For more information, see <a class="reference external" href="https://pytorch.org/audio/stable/generated/torchaudio.load.html">torchaudio.load()</a>.</p></li>
</ul>
<p>In the examples below, the function is running locally, for running remotely, it is required to build the function’s image first (need to execute only once):</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">noise_reduction_function</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">mlrun</span><span class="o">.</span><span class="n">auto_mount</span><span class="p">())</span> <span class="c1"># required for local files</span>
<span class="n">project</span><span class="o">.</span><span class="n">build_function</span><span class="p">(</span><span class="s2">"noise-reduction"</span><span class="p">)</span>
</pre></div>
</div>
<section id="example">
<h4>1.1. Example<a class="headerlink" href="#example" title="Permalink to this headline">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dfn_run</span> <span class="o">=</span> <span class="n">noise_reduction_function</span><span class="o">.</span><span class="n">run</span><span class="p">(</span>
    <span class="n">handler</span><span class="o">=</span><span class="s2">"reduce_noise_dfn"</span><span class="p">,</span>
    <span class="n">inputs</span><span class="o">=</span><span class="p">{</span><span class="s2">"audio_source"</span><span class="p">:</span> <span class="n">audio_source</span><span class="p">},</span>
    <span class="n">params</span><span class="o">=</span><span class="p">{</span>
        <span class="s2">"target_directory"</span><span class="p">:</span> <span class="s2">"./clean_data"</span><span class="p">,</span>
        <span class="s2">"use_multiprocessing"</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
        <span class="s2">"silence_threshold"</span><span class="p">:</span> <span class="mi">50</span><span class="p">,</span>
        <span class="s2">"atten_lim_db"</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span>
    <span class="p">},</span>
    <span class="n">returns</span><span class="o">=</span><span class="p">[</span><span class="s2">"successes: file"</span><span class="p">,</span> <span class="s2">"errors: file"</span><span class="p">],</span>
    <span class="n">local</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&gt; 2024-03-04 15:54:56,999 [info] Storing function: {'name': 'noise-reduce-reduce-noise-dfn', 'uid': '9732dac831784a6a8b53acab5ff83a08', 'db': 'http://mlrun-api:8080'}
&gt; 2024-03-04 15:55:07,525 [info] logging run results to: http://mlrun-api:8080
&gt; 2024-03-04 15:55:07,702 [info] Reducing noise from audio files.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Noise-reduction:   0%|          | 0/2 [00:00&lt;?, ?file/s]`torchaudio.backend.common.AudioMetaData` has been moved to `torchaudio.AudioMetaData`. Please update the import path.
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&gt; 2024-03-04 15:55:08,437 [info] Loading DeepFilterNet2 model.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>`torchaudio.backend.common.AudioMetaData` has been moved to `torchaudio.AudioMetaData`. Please update the import path.
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-03-04 15:55:08 | INFO     | DF | Running on torch 2.1.2+cu121
2024-03-04 15:55:08 | INFO     | DF | Running on host jupyter-yoni-d56767c87-678n2
&gt; 2024-03-04 15:55:08,464 [info] Loading DeepFilterNet2 model.
2024-03-04 15:55:08 | INFO     | DF | Running on torch 2.1.2+cu121
2024-03-04 15:55:08 | INFO     | DF | Running on host jupyter-yoni-d56767c87-678n2
2024-03-04 15:55:08 | INFO     | DF | Loading model settings of DeepFilterNet3
2024-03-04 15:55:08 | INFO     | DF | Using DeepFilterNet3 model at /igz/.cache/DeepFilterNet/DeepFilterNet3
2024-03-04 15:55:08 | INFO     | DF | Initializing model `deepfilternet3`
2024-03-04 15:55:08 | INFO     | DF | Loading model settings of DeepFilterNet3
2024-03-04 15:55:08 | INFO     | DF | Using DeepFilterNet3 model at /igz/.cache/DeepFilterNet/DeepFilterNet3
2024-03-04 15:55:08 | INFO     | DF | Initializing model `deepfilternet3`
2024-03-04 15:55:08 | INFO     | DF | Found checkpoint /igz/.cache/DeepFilterNet/DeepFilterNet3/checkpoints/model_120.ckpt.best with epoch 120
2024-03-04 15:55:08 | INFO     | DF | Found checkpoint /igz/.cache/DeepFilterNet/DeepFilterNet3/checkpoints/model_120.ckpt.best with epoch 120
2024-03-04 15:55:08 | INFO     | DF | Running on device cpu
2024-03-04 15:55:08 | INFO     | DF | Running on device cpu
2024-03-04 15:55:08 | INFO     | DF | Model loaded
2024-03-04 15:55:08 | INFO     | DF | Model loaded
&gt; 2024-03-04 15:55:08,635 [info] Reducing noise from test_data.mp3.
&gt; 2024-03-04 15:55:08,636 [info] Reducing noise from test_data.wav.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span><span class="-Color -Color-Green">2024-03-04 15:55:08</span> | <span class="-Color -Color-Bold -Color-Bold-Yellow">WARNING </span> | <span class="-Color -Color-Cyan">DF</span> | <span class="-Color -Color-Bold -Color-Bold-Yellow">Audio sampling rate does not match model sampling rate (16000, 48000). Resampling...</span>
"sinc_interpolation" resampling method name is being deprecated and replaced by "sinc_interp_hann" in the next release. The default behavior remains unchanged.
The MPEG_LAYER_III subtype is unknown to TorchAudio. As a result, the bits_per_sample attribute will be set to 0. If you are seeing this warning, please report by opening an issue on github (after checking for existing/closed ones). You may otherwise ignore this warning.
<span class="-Color -Color-Green">2024-03-04 15:55:08</span> | <span class="-Color -Color-Bold -Color-Bold-Yellow">WARNING </span> | <span class="-Color -Color-Cyan">DF</span> | <span class="-Color -Color-Bold -Color-Bold-Yellow">Audio sampling rate does not match model sampling rate (16000, 48000). Resampling...</span>
"sinc_interpolation" resampling method name is being deprecated and replaced by "sinc_interp_hann" in the next release. The default behavior remains unchanged.
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&gt; 2024-03-04 15:55:16,701 [info] Saved cleaned audio file to clean_data/test_data.wav.
&gt; 2024-03-04 15:55:16,706 [info] Saved cleaned audio file to clean_data/test_data_mp3.wav.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Noise-reduction: 100%|██████████| 2/2 [00:09&lt;00:00,  4.51s/file]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&gt; 2024-03-04 15:55:16,791 [info] Summarizing the results.
&gt; 2024-03-04 15:55:16,792 [info] Done (2/2)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<div class="output text_html"><style>
.dictlist {
  background-color: #4EC64B;
  text-align: center;
  margin: 4px;
  border-radius: 3px; padding: 0px 3px 1px 3px; display: inline-block;}
.artifact {
  cursor: pointer;
  background-color: #4EC64B;
  text-align: left;
  margin: 4px; border-radius: 3px; padding: 0px 3px 1px 3px; display: inline-block;
}
div.block.hidden {
  display: none;
}
.clickable {
  cursor: pointer;
}
.ellipsis {
  display: inline-block;
  max-width: 60px;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}
.master-wrapper {
  display: flex;
  flex-flow: row nowrap;
  justify-content: flex-start;
  align-items: stretch;
}
.master-tbl {
  flex: 3
}
.master-wrapper > div {
  margin: 4px;
  padding: 10px;
}
iframe.fileview {
  border: 0 none;
  height: 100%;
  width: 100%;
  white-space: pre-wrap;
}
.pane-header-title {
  width: 80%;
  font-weight: 500;
}
.pane-header {
  line-height: 1;
  background-color: #4EC64B;
  padding: 3px;
}
.pane-header .close {
  font-size: 20px;
  font-weight: 700;
  float: right;
  margin-top: -5px;
}
.master-wrapper .right-pane {
  border: 1px inset silver;
  width: 40%;
  min-height: 300px;
  flex: 3
  min-width: 500px;
}
.master-wrapper * {
  box-sizing: border-box;
}
</style><script>
function copyToClipboard(fld) {
    if (document.queryCommandSupported && document.queryCommandSupported('copy')) {
        var textarea = document.createElement('textarea');
        textarea.textContent = fld.innerHTML;
        textarea.style.position = 'fixed';
        document.body.appendChild(textarea);
        textarea.select();

        try {
            return document.execCommand('copy'); // Security exception may be thrown by some browsers.
        } catch (ex) {

        } finally {
            document.body.removeChild(textarea);
        }
    }
}
function expandPanel(el) {
  const panelName = "#" + el.getAttribute('paneName');
  console.log(el.title);

  document.querySelector(panelName + "-title").innerHTML = el.title
  iframe = document.querySelector(panelName + "-body");

  const tblcss = `<style> body { font-family: Arial, Helvetica, sans-serif;}
    #csv { margin-bottom: 15px; }
    #csv table { border-collapse: collapse;}
    #csv table td { padding: 4px 8px; border: 1px solid silver;} </style>`;

  function csvToHtmlTable(str) {
    return '<div id="csv"><table><tr><td>' +  str.replace(/[\n\r]+$/g, '').replace(/[\n\r]+/g, '</td></tr><tr><td>')
      .replace(/,/g, '</td><td>') + '</td></tr></table></div>';
  }

  function reqListener () {
    if (el.title.endsWith(".csv")) {
      iframe.setAttribute("srcdoc", tblcss + csvToHtmlTable(this.responseText));
    } else {
      iframe.setAttribute("srcdoc", this.responseText);
    }
    console.log(this.responseText);
  }

  const oReq = new XMLHttpRequest();
  oReq.addEventListener("load", reqListener);
  oReq.open("GET", el.title);
  oReq.send();


  //iframe.src = el.title;
  const resultPane = document.querySelector(panelName + "-pane");
  if (resultPane.classList.contains("hidden")) {
    resultPane.classList.remove("hidden");
  }
}
function closePanel(el) {
  const panelName = "#" + el.getAttribute('paneName')
  const resultPane = document.querySelector(panelName + "-pane");
  if (!resultPane.classList.contains("hidden")) {
    resultPane.classList.add("hidden");
  }
}

</script>
<div class="master-wrapper">
<div class="block master-tbl"><div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th>project</th>
<th>uid</th>
<th>iter</th>
<th>start</th>
<th>state</th>
<th>name</th>
<th>labels</th>
<th>inputs</th>
<th>parameters</th>
<th>results</th>
<th>artifacts</th>
</tr>
</thead>
<tbody>
<tr>
<td>noise-reduction</td>
<td><div title="9732dac831784a6a8b53acab5ff83a08"><a href="https://dashboard.default-tenant.app.llm5.iguazio-cd1.com/mlprojects/noise-reduction/jobs/monitor/9732dac831784a6a8b53acab5ff83a08/overview" target="_blank">...5ff83a08</a></div></td>
<td>0</td>
<td>Mar 04 15:54:57</td>
<td>completed</td>
<td>noise-reduce-reduce-noise-dfn</td>
<td><div class="dictlist">v3io_user=yonis</div><div class="dictlist">kind=local</div><div class="dictlist">owner=yonis</div><div class="dictlist">host=jupyter-yoni-d56767c87-678n2</div></td>
<td><div title="/User/noise-reduce/data">audio_source</div></td>
<td><div class="dictlist">target_directory=./clean_data</div><div class="dictlist">use_multiprocessing=2</div><div class="dictlist">silence_threshold=50</div><div class="dictlist">atten_lim_db=10</div></td>
<td></td>
<td><div class="artifact" onclick="expandPanel(this)" panename="result30c3eb2f" title="files/v3io/projects/noise-reduction/artifacts/noise-reduce-reduce-noise-dfn/0/successes.json">successes</div><div class="artifact" onclick="expandPanel(this)" panename="result30c3eb2f" title="files/v3io/projects/noise-reduction/artifacts/noise-reduce-reduce-noise-dfn/0/errors.json">errors</div></td>
</tr>
</tbody>
</table>
</div></div>
<div class="right-pane block hidden" id="result30c3eb2f-pane">
<div class="pane-header">
<span class="pane-header-title" id="result30c3eb2f-title">Title</span>
<span class="close clickable" onclick="closePanel(this)" panename="result30c3eb2f">×</span>
</div>
<iframe class="fileview" id="result30c3eb2f-body"></iframe>
</div>
</div>
</div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<div class="output text_html"><b> &gt; to track results use the .show() or .logs() methods  or <a href="https://dashboard.default-tenant.app.llm5.iguazio-cd1.com/mlprojects/noise-reduction/jobs/monitor/9732dac831784a6a8b53acab5ff83a08/overview" target="_blank">click here</a> to open in UI</b></div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&gt; 2024-03-04 15:55:17,976 [info] Run execution finished: {'status': 'completed', 'name': 'noise-reduce-reduce-noise-dfn'}
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="looking-at-the-result">
<h3>Looking at the result<a class="headerlink" href="#looking-at-the-result" title="Permalink to this headline">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dfn_run</span><span class="o">.</span><span class="n">artifact</span><span class="p">(</span><span class="s2">"successes"</span><span class="p">)</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="n">dfn_run</span><span class="o">.</span><span class="n">artifact</span><span class="p">(</span><span class="s2">"errors"</span><span class="p">)</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;IPython.core.display.JSON object&gt;
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;IPython.core.display.JSON object&gt;
</pre></div>
</div>
</div>
</div>
<p><a id="SpectralGating"></a></p>
</section>
<section id="spectral-gating">
<h3>2. Spectral Gating<a class="headerlink" href="#spectral-gating" title="Permalink to this headline">#</a></h3>
<p><img alt="image.png" src="attachment:68c16acf-c28e-4bb8-a453-abbebc0137ce.png"/></p>
<p>In order to use this technique, you simply need to use the <code class="docutils literal notranslate"><span class="pre">reduce_noise</span></code> handler.</p>
<p>Spectral gating selectively filters signal frequencies based on amplitude, offering targeted noise reduction or feature enhancement in signal processing applications.</p>
<p>Reduce noise from an audio file or directory containing audio files. The audio files must be in .wav format. The cleaned audio files will be saved in the target directory. For information about the noise reduction algorithm, see <a class="reference external" href="https://github.com/timsainb/noisereduce">noisereduce GitHub</a>. Notice that the saved files are in .wav format, even if the original files are in another format.</p>
</section>
<section id="id1">
<h3>Parameters:<a class="headerlink" href="#id1" title="Permalink to this headline">#</a></h3>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">audio_source</span></code>: path to the audio file or directory containing audio files</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">target_directory</span></code>: path to the directory to save the cleaned audio files.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">sample_rate</span></code>: Number of samples in one second in the audio file. Pass <code class="docutils literal notranslate"><span class="pre">None</span></code> to keep the original sample rate.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">duration</span></code>: Duration of the audio file to clean in seconds. Pass <code class="docutils literal notranslate"><span class="pre">None</span></code> to keep the original duration.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">channel</span></code>: Channel to clean. Pass the number of the channel to clean. To clean all channels, pass <code class="docutils literal notranslate"><span class="pre">None</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">silence_threshold</span></code>: The threshold to remove silence from the audio, in dB. If <code class="docutils literal notranslate"><span class="pre">None</span></code>, no silence removal is performed.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">use_multiprocessing</span></code>: Number of processes to use for cleaning the audio files. If 0, no multiprocessing is used.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">verbose</span></code>: Verbosity level. If True, display a progress bar.</p></li>
</ul>
<section id="id2">
<h4>2.1. Example<a class="headerlink" href="#id2" title="Permalink to this headline">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">noise_reduction_run</span> <span class="o">=</span> <span class="n">noise_reduction_function</span><span class="o">.</span><span class="n">run</span><span class="p">(</span>
    <span class="n">handler</span><span class="o">=</span><span class="s2">"reduce_noise"</span><span class="p">,</span>
    <span class="n">inputs</span><span class="o">=</span><span class="p">{</span><span class="s2">"audio_source"</span><span class="p">:</span> <span class="n">audio_source</span><span class="p">},</span>
    <span class="n">params</span><span class="o">=</span><span class="p">{</span>
        <span class="s2">"target_directory"</span><span class="p">:</span> <span class="s2">"./clean_data"</span><span class="p">,</span>
        <span class="s2">"use_multiprocessing"</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
        <span class="s2">"silence_threshold"</span><span class="p">:</span> <span class="mi">50</span><span class="p">,</span>
    <span class="p">},</span>
    <span class="n">local</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">returns</span><span class="o">=</span><span class="p">[</span><span class="s2">"successes: file"</span><span class="p">,</span> <span class="s2">"errors: file"</span><span class="p">],</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&gt; 2024-03-04 16:07:39,378 [info] Storing function: {'name': 'noise-reduce-reduce-noise', 'uid': '6e6d6f7c3f8243b995dc1bbcf66f7544', 'db': 'http://mlrun-api:8080'}
&gt; 2024-03-04 16:07:39,541 [info] Reducing noise from audio files.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Noise-reduction:   0%|          | 0/2 [00:00&lt;?, ?file/s]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&gt; 2024-03-04 16:07:39,565 [info] Reducing noise from test_data.mp3.
&gt; 2024-03-04 16:07:39,566 [info] Reducing noise from test_data.wav.
&gt; 2024-03-04 16:07:46,174 [info] Saved cleaned audio file to clean_data/test_data.wav.
&gt; 2024-03-04 16:07:46,175 [info] Saved cleaned audio file to clean_data/test_data_mp3.wav.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Noise-reduction: 100%|██████████| 2/2 [00:06&lt;00:00,  3.31s/file]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&gt; 2024-03-04 16:07:46,211 [info] Summarizing the results.
&gt; 2024-03-04 16:07:46,212 [info] Done (2/2)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<div class="output text_html"><style>
.dictlist {
  background-color: #4EC64B;
  text-align: center;
  margin: 4px;
  border-radius: 3px; padding: 0px 3px 1px 3px; display: inline-block;}
.artifact {
  cursor: pointer;
  background-color: #4EC64B;
  text-align: left;
  margin: 4px; border-radius: 3px; padding: 0px 3px 1px 3px; display: inline-block;
}
div.block.hidden {
  display: none;
}
.clickable {
  cursor: pointer;
}
.ellipsis {
  display: inline-block;
  max-width: 60px;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}
.master-wrapper {
  display: flex;
  flex-flow: row nowrap;
  justify-content: flex-start;
  align-items: stretch;
}
.master-tbl {
  flex: 3
}
.master-wrapper > div {
  margin: 4px;
  padding: 10px;
}
iframe.fileview {
  border: 0 none;
  height: 100%;
  width: 100%;
  white-space: pre-wrap;
}
.pane-header-title {
  width: 80%;
  font-weight: 500;
}
.pane-header {
  line-height: 1;
  background-color: #4EC64B;
  padding: 3px;
}
.pane-header .close {
  font-size: 20px;
  font-weight: 700;
  float: right;
  margin-top: -5px;
}
.master-wrapper .right-pane {
  border: 1px inset silver;
  width: 40%;
  min-height: 300px;
  flex: 3
  min-width: 500px;
}
.master-wrapper * {
  box-sizing: border-box;
}
</style><script>
function copyToClipboard(fld) {
    if (document.queryCommandSupported && document.queryCommandSupported('copy')) {
        var textarea = document.createElement('textarea');
        textarea.textContent = fld.innerHTML;
        textarea.style.position = 'fixed';
        document.body.appendChild(textarea);
        textarea.select();

        try {
            return document.execCommand('copy'); // Security exception may be thrown by some browsers.
        } catch (ex) {

        } finally {
            document.body.removeChild(textarea);
        }
    }
}
function expandPanel(el) {
  const panelName = "#" + el.getAttribute('paneName');
  console.log(el.title);

  document.querySelector(panelName + "-title").innerHTML = el.title
  iframe = document.querySelector(panelName + "-body");

  const tblcss = `<style> body { font-family: Arial, Helvetica, sans-serif;}
    #csv { margin-bottom: 15px; }
    #csv table { border-collapse: collapse;}
    #csv table td { padding: 4px 8px; border: 1px solid silver;} </style>`;

  function csvToHtmlTable(str) {
    return '<div id="csv"><table><tr><td>' +  str.replace(/[\n\r]+$/g, '').replace(/[\n\r]+/g, '</td></tr><tr><td>')
      .replace(/,/g, '</td><td>') + '</td></tr></table></div>';
  }

  function reqListener () {
    if (el.title.endsWith(".csv")) {
      iframe.setAttribute("srcdoc", tblcss + csvToHtmlTable(this.responseText));
    } else {
      iframe.setAttribute("srcdoc", this.responseText);
    }
    console.log(this.responseText);
  }

  const oReq = new XMLHttpRequest();
  oReq.addEventListener("load", reqListener);
  oReq.open("GET", el.title);
  oReq.send();


  //iframe.src = el.title;
  const resultPane = document.querySelector(panelName + "-pane");
  if (resultPane.classList.contains("hidden")) {
    resultPane.classList.remove("hidden");
  }
}
function closePanel(el) {
  const panelName = "#" + el.getAttribute('paneName')
  const resultPane = document.querySelector(panelName + "-pane");
  if (!resultPane.classList.contains("hidden")) {
    resultPane.classList.add("hidden");
  }
}

</script>
<div class="master-wrapper">
<div class="block master-tbl"><div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th>project</th>
<th>uid</th>
<th>iter</th>
<th>start</th>
<th>state</th>
<th>name</th>
<th>labels</th>
<th>inputs</th>
<th>parameters</th>
<th>results</th>
<th>artifacts</th>
</tr>
</thead>
<tbody>
<tr>
<td>noise-reduction</td>
<td><div title="6e6d6f7c3f8243b995dc1bbcf66f7544"><a href="https://dashboard.default-tenant.app.llm5.iguazio-cd1.com/mlprojects/noise-reduction/jobs/monitor/6e6d6f7c3f8243b995dc1bbcf66f7544/overview" target="_blank">...f66f7544</a></div></td>
<td>0</td>
<td>Mar 04 16:07:39</td>
<td>completed</td>
<td>noise-reduce-reduce-noise</td>
<td><div class="dictlist">v3io_user=yonis</div><div class="dictlist">kind=local</div><div class="dictlist">owner=yonis</div><div class="dictlist">host=jupyter-yoni-d56767c87-678n2</div></td>
<td><div title="/User/noise-reduce/data">audio_source</div></td>
<td><div class="dictlist">target_directory=./clean_data</div><div class="dictlist">use_multiprocessing=2</div><div class="dictlist">silence_threshold=50</div></td>
<td></td>
<td><div class="artifact" onclick="expandPanel(this)" panename="result4fd4b5be" title="files/v3io/projects/noise-reduction/artifacts/noise-reduce-reduce-noise/0/successes.json">successes</div><div class="artifact" onclick="expandPanel(this)" panename="result4fd4b5be" title="files/v3io/projects/noise-reduction/artifacts/noise-reduce-reduce-noise/0/errors.json">errors</div></td>
</tr>
</tbody>
</table>
</div></div>
<div class="right-pane block hidden" id="result4fd4b5be-pane">
<div class="pane-header">
<span class="pane-header-title" id="result4fd4b5be-title">Title</span>
<span class="close clickable" onclick="closePanel(this)" panename="result4fd4b5be">×</span>
</div>
<iframe class="fileview" id="result4fd4b5be-body"></iframe>
</div>
</div>
</div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<div class="output text_html"><b> &gt; to track results use the .show() or .logs() methods  or <a href="https://dashboard.default-tenant.app.llm5.iguazio-cd1.com/mlprojects/noise-reduction/jobs/monitor/6e6d6f7c3f8243b995dc1bbcf66f7544/overview" target="_blank">click here</a> to open in UI</b></div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&gt; 2024-03-04 16:07:46,389 [info] Run execution finished: {'status': 'completed', 'name': 'noise-reduce-reduce-noise'}
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="id3">
<h3>Looking at the result<a class="headerlink" href="#id3" title="Permalink to this headline">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dfn_run</span><span class="o">.</span><span class="n">artifact</span><span class="p">(</span><span class="s2">"successes"</span><span class="p">)</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="n">dfn_run</span><span class="o">.</span><span class="n">artifact</span><span class="p">(</span><span class="s2">"errors"</span><span class="p">)</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;IPython.core.display.JSON object&gt;
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;IPython.core.display.JSON object&gt;
</pre></div>
</div>
</div>
</div>
<p>The output of this function is the same as the first one.</p>
</section>
</section>
</section>
</div>
</main>
<footer class="footer-article noprint">
<!-- Previous / next buttons -->
<div class="prev-next-area">
</div>
</footer>
</div>
</div>
<div class="footer-content row">
<footer class="col footer"><p>
  
      © Copyright .<br/>
</p>
</footer>
</div>
</div>
</div>
</div>
<!-- Scripts loaded after <body> so the DOM is not blocked -->
<script src="../../../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>
</body>
</html>